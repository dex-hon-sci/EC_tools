<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>simple_trade - EC_tools Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "simple_trade";
        var mkdocs_page_input_path = "EC_tools/simple_trade.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> EC_tools Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../about/">About</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../main/">Main</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">EC_tools</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../EC_tools/">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../read/">read</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../plot/">plot</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../portfolio/">portfolio</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../position/">position</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../strategy/">strategy</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">simple_trade</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#EC_tools.simple_trade">simple_trade</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#EC_tools.simple_trade.onetrade_simple">onetrade_simple</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#EC_tools.simple_trade.onetrade_simple_LEGACY">onetrade_simple_LEGACY</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../trade/">trade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../backtest/">backtest</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../utility/">utility</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Applications</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../app/app/">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../app/run_apc_price_study/">Run APC Study</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../app/run_backtest/">Run Backtest</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../app/run_comparison_plot/">Run Comparison Plot</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../app/run_daily_instruction/">Run Daily Instruction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../app/run_data_management/">Run Data Management</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../app/run_gen_monthly_MR_dir/">Run Generate Monthly MR signals</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../app/run_gen_MR_dir/">Run Generate Daily MR signals</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../../app/run_plot_heatamp.md">Run Plot Backtest Heatmap</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../app/run_PNL_plot/">Run PNL Plots</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../app/run_preprocess/">Run Preprocess</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../app/run_update_db/">Run Update DB</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">EC_tools Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">EC_tools</li>
      <li class="breadcrumb-item active">simple_trade</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="simple_trade">Simple_Trade</h1>


<div class="doc doc-object doc-module">



<a id="EC_tools.simple_trade"></a>
    <div class="doc doc-contents first">

        <p>Created on Wed Aug  7 16:48:40 2024</p>
<p>@author: dexter</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="EC_tools.simple_trade.onetrade_simple" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">onetrade_simple</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>A simple trading method that returns a pair of trade open and close time
as long as the price. </p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>EES_dict</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>A dictionary containing the points that crosses over the Entry, Exit, 
and Stop Loss points (EES), as well as the closing time and price of
the trading day.
This should be the output of find_minute_EES from EC_tools.read module.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>tuple</code>
              –
              <div class="doc-md-description">
                <p>Two tuples containing rhe trade open and trade close in the format of 
(time. price).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>EC_tools/simple_trade.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="k">def</span> <span class="nf">onetrade_simple</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]:</span> 
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    A simple trading method that returns a pair of trade open and close time</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    as long as the price. </span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    EES_dict : dict</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        A dictionary containing the points that crosses over the Entry, Exit, </span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        and Stop Loss points (EES), as well as the closing time and price of</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        the trading day.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        This should be the output of find_minute_EES from EC_tools.read module.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    -------</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    tuple</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        Two tuples containing rhe trade open and trade close in the format of </span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        (time. price).</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">entry_pt</span><span class="p">,</span> <span class="n">exit_pt</span><span class="p">,</span> <span class="n">stop_pt</span><span class="p">,</span> <span class="n">close_pt</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span>\
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>                                           <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">earliest_exit</span><span class="p">,</span> <span class="n">earliest_stop</span> <span class="o">=</span> <span class="n">exit_pt</span><span class="p">,</span> <span class="n">stop_pt</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="c1"># closr_pt always exist so we do it outside of the switch cases</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">close_pt</span> <span class="o">=</span> <span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">if</span> <span class="n">close_pt</span> <span class="o">==</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no close WTF&#39;</span><span class="p">,</span> <span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">])</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">close_pt</span><span class="p">),</span> <span class="n">close_pt</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="c1"># To get the correct EES and close time and price</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># entry price not hit. No trade that day.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="c1">#print(&#39;no entry&#39;, EES_dict[&#39;entry&#39;], close_pt)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="n">trade_open</span><span class="p">,</span> <span class="n">trade_close</span> <span class="o">=</span>  <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="c1"># choose the entry point</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="n">entry_pt</span> <span class="o">=</span> <span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">trade_open</span> <span class="o">=</span> <span class="n">entry_pt</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;exit&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="c1"># Find exit point candidates</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">exit_cand</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;exit&#39;</span><span class="p">]):</span>  
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                <span class="k">if</span> <span class="n">exit_cand</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">entry_pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                    <span class="n">earliest_exit</span> <span class="o">=</span> <span class="n">exit_cand</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                    <span class="c1">#print(&#39;earliest_exit&#39;, earliest_exit)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                    <span class="k">break</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="c1"># Finde stop loss point candidates</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">stop_cand</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]):</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>                <span class="k">if</span> <span class="n">stop_cand</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">entry_pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>                    <span class="n">earliest_stop</span> <span class="o">=</span> <span class="n">stop_cand</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>                    <span class="c1">#print(&#39;earliest_stop&#39;, earliest_stop)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                    <span class="k">break</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="c1"># put in the new exit and stop</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">exit_pt</span> <span class="o">=</span> <span class="n">earliest_exit</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">stop_pt</span> <span class="o">=</span> <span class="n">earliest_stop</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="c1">#print(&#39;SSC_key&#39;, exit_pt, stop_pt, close_pt)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="c1">#see which points comes the earliest</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">if</span> <span class="n">exit_pt</span> <span class="o">==</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="ow">and</span> <span class="n">stop_pt</span> <span class="o">==</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="c1">#print(&#39;both null&#39;)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="n">trade_close</span> <span class="o">=</span> <span class="n">close_pt</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="k">elif</span> <span class="n">exit_pt</span> <span class="o">!=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="ow">and</span> <span class="n">stop_pt</span> <span class="o">==</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="n">trade_close</span> <span class="o">=</span> <span class="n">exit_pt</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="c1">#print(&#39;stop null&#39;)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="k">elif</span> <span class="n">exit_pt</span> <span class="o">==</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="ow">and</span> <span class="n">stop_pt</span> <span class="o">!=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="n">trade_close</span> <span class="o">=</span> <span class="n">stop_pt</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="c1">#print(&#39;exit null&#39;)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">elif</span> <span class="n">exit_pt</span> <span class="o">!=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="ow">and</span> <span class="n">stop_pt</span> <span class="o">!=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="k">if</span> <span class="n">exit_pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">stop_pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                <span class="c1">#print(&#39;stop loss&#39;)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                <span class="n">trade_close</span> <span class="o">=</span> <span class="n">stop_pt</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="k">elif</span> <span class="n">exit_pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">stop_pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                <span class="c1">#print(&#39;exit&#39;)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                <span class="n">trade_close</span> <span class="o">=</span> <span class="n">exit_pt</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;WTF&quot;</span><span class="p">)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="k">if</span> <span class="n">trade_open</span> <span class="o">!=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="ow">and</span> <span class="n">trade_close</span> <span class="o">==</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;trade WTF </span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">trade_open</span><span class="p">,</span> <span class="n">trade_close</span><span class="p">))</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="c1">#print(&#39;trade&#39;, trade_open, trade_close, type(trade_open), type(trade_close))</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="k">return</span> <span class="n">trade_open</span><span class="p">,</span> <span class="n">trade_close</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="EC_tools.simple_trade.onetrade_simple_LEGACY" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">onetrade_simple_LEGACY</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>LEGACY code before the development of trade and portfolio modules
a function that control which price to buy and sell.</p>
<p>The trade logic is incorrect in this one (It hit the stop-loss automatically)</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>EES_dict</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>A dictionary containing the points that crosses over the Entry, Exit, 
and Stop Loss points (EES), as well as the closing time and price of
the trading day.
This should be the output of find_minute_EES from EC_tools.read module.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>tuple</code>
              –
              <div class="doc-md-description">
                <p>Two tuples containing rhe trade open and trade close in the format of 
(time. price).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>EC_tools/simple_trade.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span> <span class="nf">onetrade_simple_LEGACY</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]:</span> 
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    LEGACY code before the development of trade and portfolio modules</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    a function that control which price to buy and sell.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    The trade logic is incorrect in this one (It hit the stop-loss automatically)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    EES_dict : dict</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        A dictionary containing the points that crosses over the Entry, Exit, </span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        and Stop Loss points (EES), as well as the closing time and price of</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        the trading day.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        This should be the output of find_minute_EES from EC_tools.read module.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    -------</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    tuple</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        Two tuples containing rhe trade open and trade close in the format of </span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        (time. price).</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="c1"># add the amount of exchange</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">trade_open</span><span class="p">,</span> <span class="n">trade_close</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="c1"># Trade logic</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># entry price not hit. No trade that day.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>        <span class="k">pass</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="c1"># choose the entry point</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="n">trade_open</span> <span class="o">=</span> <span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># if the stop loss wasn&#39;t hit</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>            <span class="k">pass</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="n">trade_close</span> <span class="o">=</span> <span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#set the trade close at stop loss</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;exit&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="n">trade_close</span> <span class="o">=</span> <span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="c1"># make sure the exit comes after the entry point</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">exit_cand</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">EES_dict</span><span class="p">[</span><span class="s1">&#39;exit&#39;</span><span class="p">]):</span>  
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>                <span class="k">if</span> <span class="n">exit_cand</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">trade_open</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>                    <span class="n">trade_close</span> <span class="o">=</span> <span class="n">exit_cand</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>                    <span class="k">break</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>                    <span class="k">pass</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">return</span> <span class="n">trade_open</span><span class="p">,</span> <span class="n">trade_close</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr />
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../strategy/" class="btn btn-neutral float-left" title="strategy"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../trade/" class="btn btn-neutral float-right" title="trade">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../strategy/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../trade/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
